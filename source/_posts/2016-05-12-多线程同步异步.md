title: 多线程同步异步
layout: post
date: 2016-05-12 02:26:28
categories: 读书笔记
tags: 驱动
---

系统实现多线程的原理以及形象的描述同步异步的基本概念
<!--more-->
## 1. 多线程原理

最简单的例子是一台电脑只有一个CPU，CPU会把时间分成一段的时间段，然后分配给各个线程。CPU执行众多线程中当前拥有时间片的线程，当时间片用光了，CPU会马上执行下一个线程，依次循环。由于人感知不到和CPU切换线程造成的及其短暂的变化。



比如：我在听歌的同时写文档。线程轮转到执行音乐播放器线程时，假设我们听到歌声的第一句歌词的千分之几。这时候线程轮转到文档编辑器，我们输入了一个字符马上又轮回到其他线程后转回音乐播放器，我们又听到了第一句歌词的一部分。如此循环下去。



## 2. 同步和异步

同步和异步描述的是线程之间执行顺序的问题。

先从简单的异步来说，异步就是每个线程之间执行的代码都是互不相干，所以各自都蒙头执行各自的代码，把线程的代码用顺序结构来抽象，那么就是在有限的时间片内能执行多快执行多快。我自己想到的例子就是个人赛跑，那每一道的选手都是一个线程，大家各跑各的，能跑多块跑多快。各自之间不会相互影响。

而同步呢，就是相对于异步的一种情况啦，线程之间是有联系的，这样多个线程配合起来执行任务。**为什么要配合起来呢**？人多力量大呗！简单的例子就是一个UI线程负责和用户交互，一个计算线程在后台进行大量的计算。这样做的好处是，大家都是受CPU调度的线程，即使计算线程非常繁忙，但是和用户交互的UI线程也不会卡顿，能接收用户的命令。

但是两个线程本身的执行流是不可预测的，A线程执行到哪儿了B线程完全一脸蒙逼，同理B对A也一样。所以这样会出现问题呀。再举个例子：你和你女朋友相约去逛街，先在某路口汇合然后一起去。对于你们这两个线程而言，一起逛街是最终目的，假设你先到路口了，但是如果你没等她，直接一个先去，你想想后果得多么严重。放在程序里也是一样，两个线程的执行流必须有个点，你腿长先执行到了这个点，你得等一等你腿短的，这就是同步，大家是配合的关系。



